!function(e){"use strict";function t(e,t){if(e.options.callbacks.hasOwnProperty(t))for(var s=0,i=e.options.callbacks[t].length;i>s;s++)e.options.callbacks[t][s](this.options.selected)}function s(e){switch(e){case"simple":return'<h6 class="selectum__head"><%=head%></h6>                        <div class="selectum__select">                            <span class="selectum__select__current i-arrow-bottom_after js-raw" data-selectum-current></span>                            <ul class="selectum__select__list" data-selectum-list>                                <li data-selectum-reset>Any</li>                            <% for ( var i = 0; i < items.length; i++ ) { %>                                <li data-selectum-id="<%=items[i].id%>" data-selectum-val="<%=items[i].val%>"><%=items[i].val%></li>                            <% } %>                            </ul>                        </div>';case"picker":return'<h3 class="selectum__head"><%=head%></h3>                        <div class="selectum__select">                            <span class="selectum__select__current i-arrow-bottom_after js-raw" data-selectum-current></span>                            <ul class="selectum__select__list" data-selectum-list>                                <li data-selectum-reset>Any</li>                            <% for ( var i = 0; i < items.length; i++ ) { %>                                <li data-selectum-id="<%=items[i].id%>" data-selectum-val="<%=items[i].val%>"><%=items[i].val%></li>                            <% } %>                            </ul>                        </div>';case"picked":return'<h3 class="selectum__head"><%=head%></h3>                        <section>                            <div class="selectum__select__current i-arrow-bottom_after js-raw" data-selectum-current></div>                            <div class="selectum__select__list" data-selectum-list data-selectum-list-hiddable="<%=listen%>">                                <button data-selectum-reset>Any</button>                            <% for ( var i = 0; i < items.length; i++ ) { %>                                <ul data-selectum-hidden-unless="<%=items[i].id%>">                                <% for ( var j = 0; j < items[i].val.length; j++ ) { %>                                    <li data-selectum-id="<%=items[i].val[j].id%>" data-selectum-val="<%=items[i].val[j].val%>"><%=items[i].val[j].val%></li>                                <% } %>                                </ul>                            <% } %>                            </div>                        </section>'}}function i(e,t){this.el=e,this.options=i.extend(this.options,{render:this.el.dataset.hasOwnProperty("selectumRender"),exist:this.el.dataset.hasOwnProperty("selectumExist"),head:this.el.dataset.hasOwnProperty("selectumHead")?this.el.dataset.selectumHead:"",picker:this.el.dataset.hasOwnProperty("selectumPicker"),picked:this.el.dataset.hasOwnProperty("selectumPicked"),emit:this.el.dataset.hasOwnProperty("selectumEmit")?this.el.dataset.selectumEmit:!1,emitReset:this.el.dataset.hasOwnProperty("selectumEmitReset")?this.el.dataset.selectumEmitReset:!1,hiddable:this.el.dataset.hasOwnProperty("selectumHiddable")?this.el.dataset.selectumHiddable:"",listen:this.el.dataset.hasOwnProperty("selectumListen")?this.el.dataset.selectumListen:!1,listenReset:this.el.dataset.hasOwnProperty("selectumListenReset")?this.el.dataset.selectumListenReset:!1,defaultText:this.el.dataset.hasOwnProperty("selectumPlaceholder")?this.el.dataset.selectumPlaceholder:"",updateUrl:this.el.dataset.hasOwnProperty("selectumUpdateUrl"),urlFetch:this.el.dataset.hasOwnProperty("selectumUrlFetch")}),i.extend(this.options,t),this._init()}!function(e){e.closest=e.closest||function t(e){return this.parentNode?this.matches(e)?this:t.call(this.parentNode,e):null}}(Element.prototype);var n={};(function(){var e={};this.tmpl=function t(i,n,l){var r=/\W/.test(i)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+i.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[i]=e[i]||t(l?i:s(i));return n?r(n):r}}).bind(i)(),i.event={},i.extend=function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);return e},i.urlUpdater=function(t,s){var i=location.pathname+location.search,s=""===s?s:isNaN(+s)?s:parseInt(+s,10),n=new RegExp("("+t+"=)(.+?)(&|$)"),l="";if(n.test(i))i=i.replace(n,function(e,t,i,n,l){return""===s?"":t+s+n}),n.lastIndex=null;else{if(""===s)return null;l=""!==location.search?"&":"?",l+=t+"="+s,i+=l}("&"===i.substring(i.length-1)||"?"===i.substring(i.length-1))&&(i=i.slice(0,i.length-1)),e.history.pushState(t,"filter",i)},i._showProperSubsets=function(e){var t="selectum-hiding-styles-"+this.el.dataset.selectum,s=document.querySelector("#"+t);s||(s=document.createElement("style"),s.id=t,document.head.appendChild(s)),s.innerHTML="[data-selectum-list-hiddable='"+this.el.dataset.selectum+"']>[data-selectum-hidden-unless='"+e+"']{display:block}"},i.prototype._setDocumentExternalClose=function(){var e=this;document.addEventListener("click",function(t){t.target.closest("[data-selectum]")||e.DOMElements.currentList.classList.contains("js-open")&&(e.DOMElements.currentList.classList.remove("js-open"),e._toggleArrows())})},i.prototype.options={inited:!1,selected:null,render:!1,exist:!1,picker:!1,picked:!1,emit:!1,emitReset:!1,listen:!1,listenReset:!1,defaultText:"",updateUrl:!1,urlFetch:!1,head:"Select an Item",hiddable:"",callbacks:{}},i.prototype._init=function(e){(!this.options.render||e)&&(this._setDOMElements(),this._initEvents(),this._setActive(),this._disabledIfDependent(),this._addHiddenStyles(),this._setDocumentExternalClose(),this._setDefaultPlaceholder(),this._setFromSearchParams(),this.options.inited=!0)},i.prototype.render=function(e){if(this.options.inited&&(this.el.innerHTML=""),null!==e&&"object"==typeof e)if("undefined"==typeof e.head&&(e.head=this.options.head||"Select"),this.options.picked&&"undefined"==typeof e.listen&&(e.listen=this.options.hiddable||"selectum"),"undefined"==typeof e.items)console.error("items key should be present");else if(Array.isArray(e.items))if(0===e.items.length)console.error("items should becontain at least one object with key: id, val");else{var t="";t=this.options.picked?"picked":this.options.picker?"picker":"simple",this.options.exist?(n.hasOwnProperty(this.el.dataset.selectum)||(n[this.el.dataset.selectum]=this.el.innerHTML.replace(/&lt;/gi,"<").replace(/&gt;/gi,">")),this.el.innerHTML=i.tmpl(n[this.el.dataset.selectum],e,!0)):this.el.innerHTML=i.tmpl(t,e),this._init(!0)}else console.error("items should be an array");else console.error("Please provide data Object to render")},i.prototype._setDefaultPlaceholder=function(){this.DOMElements.currentFilter.textContent=this.options.defaultText},i.prototype._disabledIfDependent=function(){this.options.picked&&this.el.classList.add("js-disabled")},i.prototype._addHiddenStyles=function(){if(this.options.picked){var e="data-selectum-list-hiddable",t=document.querySelector("#"+e);t||(t=document.createElement("style"),t.id=e,document.head.appendChild(t),t.innerHTML="[data-selectum-list-hiddable]{display:none}")}},i.prototype._setDOMElements=function(){this.DOMElements={},this.DOMElements.currentFilter=this.el.querySelector("[data-selectum-current]"),this.DOMElements.currentClickable=null===this.el.querySelector("[data-selectum-clickable]")?this.el:this.el.querySelector("[data-selectum-clickable]"),this.DOMElements.resetButton=this.el.querySelector("[data-selectum-reset]"),this.DOMElements.currentList=this.el.querySelector("[data-selectum-list]"),this.DOMElements.currentListElement=this.el.querySelectorAll("[data-selectum-id]")},i.prototype._createResetModelEvent=function(){this.options.emit&&(i.event[this.options.emit]=document.createEvent("Event"),"function"==typeof i.event[this.options.emit].initEvent?i.event[this.options.emit].initEvent(this.options.emit,!0,!0):"function"==typeof i.event[this.options.emit].initCustomEvent&&i.event.initCustomEvent(this.options.emit,!0,!0,null))},i.prototype._createResetEvent=function(){this.options.emitReset&&(i.event[this.options.emitReset]=document.createEvent("Event"),"function"==typeof i.event[this.options.emitReset].initEvent?i.event[this.options.emitReset].initEvent(this.options.emitReset,!0,!0):"function"==typeof i.event[this.options.emitReset].initCustomEvent&&i.event.initCustomEvent(this.options.emitReset,!0,!0,null))},i.prototype._initEvents=function(){this._toggleDropdown(),this._onOptionClick(),this._createResetModelEvent(),this._createResetEvent(),this._clearCurrentOnExtraPick(),this._resetIfDependent(),this._initResetButton()},i.prototype.on=function(e,t){this.options.callbacks[e].push(t)},i.prototype.off=function(e){delete this.options.callbacks[e]},i.prototype._initResetButton=function(){var e=this;e.DOMElements.resetButton&&e.DOMElements.resetButton.addEventListener("click",function(){e.DOMElements.currentFilter.textContent="",e.DOMElements.currentList.classList.remove("js-open"),e._toggleArrows(),e.DOMElements.currentFilter.classList.add("js-raw"),e._setDefaultPlaceholder(),e._setSelected(null),e._setActive(),e._emitResetEvent(),i.urlUpdater(e.el.dataset.selectum,""),t(e,"reset")})},i.prototype._clearCurrentOnExtraPick=function(){var e=this;e.options.listen&&document.addEventListener(e.options.listen,function(){e.DOMElements.currentFilter.classList.contains("js-raw")||(e.DOMElements.currentFilter.textContent="",e.DOMElements.currentFilter.classList.add("js-raw"),e._setDefaultPlaceholder(),i.urlUpdater(e.el.dataset.selectum,"")),e.options.picked&&(e.options.picked=!1,e.el.classList.remove("js-disabled"),e.DOMElements.currentFilter.classList.remove("i-arrow-bottom-disabled_after"),e.DOMElements.currentFilter.classList.add("i-arrow-bottom_after"),e.options.selected&&e.DOMElements.currentFilter.classList.remove("js-raw"))})},i.prototype._resetIfDependent=function(){var e=this;e.options.listenReset&&e.options.picked&&document.addEventListener(e.options.listenReset,function(){e.options.picked=!0,e.options.selected=null,e.el.classList.add("js-disabled"),e.DOMElements.currentFilter.textContent="",e.DOMElements.currentFilter.classList.add("js-raw","i-arrow-bottom-disabled_after"),e.DOMElements.currentFilter.classList.remove("i-arrow-bottom_after"),e._setDefaultPlaceholder(),i.urlUpdater(e.el.dataset.selectum,"")})},i.prototype._toggleArrows=function(){this.DOMElements.currentFilter.classList.contains("i-arrow-bottom_after")||this.DOMElements.currentFilter.classList.contains("i-arrow-bottom-disabled_after")?(this.DOMElements.currentFilter.classList.remove("i-arrow-bottom_after","i-arrow-bottom-disabled_after"),this.DOMElements.currentFilter.classList.add("i-arrow-top_after"),this.el.classList.add("js-open")):(this.DOMElements.currentFilter.classList.remove("i-arrow-top_after"),this.DOMElements.currentFilter.classList.add("i-arrow-bottom_after"),this.el.classList.remove("js-open"))},i.prototype._toggleDropdown=function(){var e=this;e.DOMElements.currentClickable.addEventListener("click",function(){e.options.picked||(e.DOMElements.currentList.classList.toggle("js-open"),e._toggleArrows())})},i.prototype._onOptionClick=function(){var e=this;[].slice.call(e.DOMElements.currentListElement).forEach(function(s){s.addEventListener("click",function(s){s.stopPropagation(),e.DOMElements.currentList.classList.remove("js-open"),e.DOMElements.currentFilter.classList.remove("js-raw"),e._toggleArrows(),e.DOMElements.currentFilter.textContent=s.target.dataset.selectumVal,e._setSelected(s.target.dataset.selectumId),e._setActive(),e._removeDisabled(),e._showSubsets(s.target.dataset.selectumId),e._updateUrl(),e._emitEvent(),t(e,"click")})})},i.prototype._updateUrl=function(){if(this.options.updateUrl){var e=""!==location.search?"&":"?";e+=this.el.dataset.selectum+"="+this.options.selected,i.urlUpdater(this.el.dataset.selectum,this.options.selected)}},i.prototype._removeDisabled=function(){this.el.removeAttribute("disabled")},i.prototype._showSubsets=function(e){this.options.picker&&i._showProperSubsets.bind(this,e)()},i.prototype._setSelected=function(e){this.options.selected=e},i.prototype._emitEvent=function(){this.options.emit&&document.dispatchEvent(i.event[this.options.emit])},i.prototype._emitResetEvent=function(){this.options.emitReset&&document.dispatchEvent(i.event[this.options.emitReset])},i.prototype._setActive=function(){var e=this.DOMElements.currentFilter.textContent;[].slice.call(this.DOMElements.currentListElement).forEach(function(t){t.dataset.selectumVal===e?t.classList.add("js-current"):t.classList.remove("js-current")})},i.prototype._setFromSearchParams=function(){if(this.options.urlFetch){var e=location.search,s=this.el.dataset.selectum;if(e.length>0){var i=/(\w+)=([\w\.\|]+)/gi;e=e.slice(1,e.length).split("&"),e=e.reduce(function(e,t){var s=i.exec(t);return e[s[1]]=s[2],i.lastIndex=null,e},{}),e.hasOwnProperty(s)&&(this.options.picked||this.DOMElements.currentFilter.classList.remove("js-raw"),this.DOMElements.currentFilter.textContent=this.el.querySelector("[data-selectum-id='"+e[s]+"']").dataset.selectumVal,this._setSelected(e[s]),this._setActive(),this._removeDisabled(),this._showSubsets(e[s]),setTimeout(this._emitEvent.bind(this),0),t(this,"init:url"))}}},e.Selectum=i}(window);var select=null;[].slice.call(document.querySelectorAll("[data-selectum]")).forEach(function(e){select=new Selectum(e)}),window.setTimeout(function(){select.render({head:select.options.head||"Any other head",items:[{id:0,val:"apple"},{id:1,val:"banana"},{id:2,val:"tangerin"}]})},3e3),window.setTimeout(function(){select.render({head:select.options.head||"Any other head",items:[{id:0,val:"some"},{id:1,val:"other"},{id:2,val:"array"}]})},7e3);