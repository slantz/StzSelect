!function(t){"use strict";function e(t,e){if(t.options.callbacks.hasOwnProperty(e))for(var s=0,i=t.options.callbacks[e].length;i>s;s++)t.options.callbacks[e][s](this.options.selected)}function s(t,e){this.el=t,this.options=s.extend(this.options,{picker:this.el.dataset.hasOwnProperty("selectumPicker"),picked:this.el.dataset.hasOwnProperty("selectumPicked"),emit:this.el.dataset.hasOwnProperty("selectumEmit")?this.el.dataset.selectumEmit:!1,emitReset:this.el.dataset.hasOwnProperty("selectumEmitReset")?this.el.dataset.selectumEmitReset:!1,listen:this.el.dataset.hasOwnProperty("selectumListen")?this.el.dataset.selectumListen:!1,listenReset:this.el.dataset.hasOwnProperty("selectumListenReset")?this.el.dataset.selectumListenReset:!1,defaultText:this.el.dataset.hasOwnProperty("selectumPlaceholder")?this.el.dataset.selectumPlaceholder:"",updateUrl:this.el.dataset.hasOwnProperty("selectumUpdateUrl")}),s.extend(this.options,e),this._init()}!function(t){t.closest=t.closest||function e(t){return this.parentNode?this.matches(t)?this:e.call(this.parentNode,t):null}}(Element.prototype),s.event={},s.extend=function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t},s.urlUpdater=function(e,s){var i=location.pathname+location.search,s=""===s?s:isNaN(+s)?s:parseInt(+s,10),n=new RegExp("("+e+"=)(.+?)(&|$)"),o="";if(n.test(i))i=i.replace(n,function(t,e,i,n,o){return""===s?"":e+s+n}),n.lastIndex=null;else{if(""===s)return null;o=""!==location.search?"&":"?",o+=e+"="+s,i+=o}("&"===i.substring(i.length-1)||"?"===i.substring(i.length-1))&&(i=i.slice(0,i.length-1)),t.history.pushState(e,"filter",i)},s._showProperSubsets=function(t){var e=document.querySelector("#czd-hiding-styles");e||(e=document.createElement("style"),e.id="czd-hiding-styles",document.head.appendChild(e)),e.innerHTML="[data-selectum-list-hiddable]>[data-selectum-hidden-unless='"+t+"']{display:block}"},s.prototype._setDocumentExternalClose=function(){var t=this;document.addEventListener("click",function(e){e.target.closest("[data-selectum]")||t.DOMElements.currentList.classList.contains("js-open")&&(t.DOMElements.currentList.classList.remove("js-open"),t._toggleArrows())})},s.prototype.options={selected:null,picker:!1,picked:!1,emit:!1,emitReset:!1,listen:!1,listenReset:!1,defaultText:"",updateUrl:!1,callbacks:{}},s.prototype._init=function(){this._setDOMElements(),this._initEvents(),this._setActive(),this._disabledIfDependent(),this._setDocumentExternalClose(),this._setDefaultPlaceholder(),this._setFromSearchParams()},s.prototype._setDefaultPlaceholder=function(){this.DOMElements.currentFilter.textContent=this.options.defaultText},s.prototype._disabledIfDependent=function(){this.options.picked&&this.el.classList.add("js-disabled")},s.prototype._setDOMElements=function(){this.DOMElements={},this.DOMElements.currentFilter=this.el.querySelector("[data-selectum-current]"),this.DOMElements.currentClickable=null===this.el.querySelector("[data-selectum-clickable]")?this.el:this.el.querySelector("[data-selectum-clickable]"),this.DOMElements.resetButton=this.el.querySelector("[data-selectum-reset]"),this.DOMElements.currentList=this.el.querySelector("[data-selectum-list]"),this.DOMElements.currentListElement=this.el.querySelectorAll("[data-selectum-id]")},s.prototype._createResetModelEvent=function(){this.options.emit&&(s.event[this.options.emit]=document.createEvent("Event"),"function"==typeof s.event[this.options.emit].initEvent?s.event[this.options.emit].initEvent(this.options.emit,!0,!0):"function"==typeof s.event[this.options.emit].initCustomEvent&&s.event.initCustomEvent(this.options.emit,!0,!0,null))},s.prototype._createResetEvent=function(){this.options.emitReset&&(s.event[this.options.emitReset]=document.createEvent("Event"),"function"==typeof s.event[this.options.emitReset].initEvent?s.event[this.options.emitReset].initEvent(this.options.emitReset,!0,!0):"function"==typeof s.event[this.options.emitReset].initCustomEvent&&s.event.initCustomEvent(this.options.emitReset,!0,!0,null))},s.prototype._initEvents=function(){this._toggleDropdown(),this._onOptionClick(),this._createResetModelEvent(),this._createResetEvent(),this._clearCurrentOnExtraPick(),this._resetIfDependent(),this._initResetButton()},s.prototype.on=function(t,e){this.options.callbacks[t].push(e)},s.prototype.off=function(t){delete this.options.callbacks[t]},s.prototype._initResetButton=function(){var t=this;t.DOMElements.resetButton&&t.DOMElements.resetButton.addEventListener("click",function(){t.DOMElements.currentFilter.textContent="",t.DOMElements.currentList.classList.remove("js-open"),t._toggleArrows(),t.DOMElements.currentFilter.classList.add("js-raw"),t._setDefaultPlaceholder(),t._setSelected(null),t._setActive(),t._emitResetEvent(),s.urlUpdater(t.el.dataset.selectum,""),e(this,"reset")})},s.prototype._clearCurrentOnExtraPick=function(){var t=this;t.options.listen&&document.addEventListener(t.options.listen,function(){t.DOMElements.currentFilter.classList.contains("js-raw")||(t.DOMElements.currentFilter.textContent="",t.DOMElements.currentFilter.classList.add("js-raw"),t._setDefaultPlaceholder(),s.urlUpdater(t.el.dataset.selectum,"")),t.options.picked&&(t.options.picked=!1,t.el.classList.remove("js-disabled"),t.DOMElements.currentFilter.classList.remove("i-arrow-bottom-disabled_after"),t.DOMElements.currentFilter.classList.add("i-arrow-bottom_after"),t.options.selected&&t.DOMElements.currentFilter.classList.remove("js-raw"))})},s.prototype._resetIfDependent=function(){var t=this;t.options.listenReset&&t.options.picked&&document.addEventListener(t.options.listenReset,function(){t.options.picked=!0,t.options.selected=null,t.el.classList.add("js-disabled"),t.DOMElements.currentFilter.textContent="",t.DOMElements.currentFilter.classList.add("js-raw","i-arrow-bottom-disabled_after"),t.DOMElements.currentFilter.classList.remove("i-arrow-bottom_after"),t._setDefaultPlaceholder(),s.urlUpdater(t.el.dataset.selectum,"")})},s.prototype._toggleArrows=function(){this.DOMElements.currentFilter.classList.contains("i-arrow-bottom_after")||this.DOMElements.currentFilter.classList.contains("i-arrow-bottom-disabled_after")?(this.DOMElements.currentFilter.classList.remove("i-arrow-bottom_after","i-arrow-bottom-disabled_after"),this.DOMElements.currentFilter.classList.add("i-arrow-top_after"),this.el.classList.add("js-open")):(this.DOMElements.currentFilter.classList.remove("i-arrow-top_after"),this.DOMElements.currentFilter.classList.add("i-arrow-bottom_after"),this.el.classList.remove("js-open"))},s.prototype._toggleDropdown=function(){var t=this;t.DOMElements.currentClickable.addEventListener("click",function(){t.options.picked||(t.DOMElements.currentList.classList.toggle("js-open"),t._toggleArrows())})},s.prototype._onOptionClick=function(){var t=this;[].slice.call(t.DOMElements.currentListElement).forEach(function(s){s.addEventListener("click",function(s){s.stopPropagation(),t.DOMElements.currentList.classList.remove("js-open"),t.DOMElements.currentFilter.classList.remove("js-raw"),t._toggleArrows(),t.DOMElements.currentFilter.textContent=s.target.dataset.selectumVal,t._setSelected(s.target.dataset.selectumId),t._setActive(),t._removeDisabled(),t._showSubsets(s.target.dataset.selectumId),t._updateUrl(),t._emitEvent(),e(this,"click")})})},s.prototype._updateUrl=function(){if(this.options.updateUrl){var t=""!==location.search?"&":"?";t+=this.el.dataset.selectum+"="+this.options.selected,s.urlUpdater(this.el.dataset.selectum,this.options.selected)}},s.prototype._removeDisabled=function(){this.el.removeAttribute("disabled")},s.prototype._showSubsets=function(t){this.options.picker&&s._showProperSubsets(t)},s.prototype._setSelected=function(t){this.options.selected=t},s.prototype._emitEvent=function(){this.options.emit&&document.dispatchEvent(s.event[this.options.emit])},s.prototype._emitResetEvent=function(){this.options.emitReset&&document.dispatchEvent(s.event[this.options.emitReset])},s.prototype._setActive=function(){var t=this.DOMElements.currentFilter.textContent;[].slice.call(this.DOMElements.currentListElement).forEach(function(e){e.dataset.selectumVal===t?e.classList.add("js-current"):e.classList.remove("js-current")})},s.prototype._setFromSearchParams=function(){var t=location.search,s=this.el.dataset.selectum;if(t.length>0){var i=/(\w+)=([\w\.\|]+)/gi;t=t.slice(1,t.length).split("&"),t=t.reduce(function(t,e){var s=i.exec(e);return t[s[1]]=s[2],i.lastIndex=null,t},{}),t.hasOwnProperty(s)&&(this.options.picked||this.DOMElements.currentFilter.classList.remove("js-raw"),this.DOMElements.currentFilter.textContent=this.el.querySelector("[data-selectum-id='"+t[s]+"']").dataset.selectumVal,this._setSelected(t[s]),this._setActive(),this._removeDisabled(),this._showSubsets(t[s]),setTimeout(this._emitEvent.bind(this),0),e(this,"init:url"))}},t.Selectum=s}(window);